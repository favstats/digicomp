---
title: "{{< iconify ph heart-pulse >}} Digital Health"
format: html
---

```{r}
#| include: false
library(dashboardr)
```

**THIS IS A MOCKUP VERSION PLEASE DO NOT CITE**

Here we can show some amazing highlights from the data.


```{=html}
<script>
// Chart Lazy Loading System
(function() {
  // Track which charts have been initialized
  const initializedCharts = new Set();
  
  // Queue of charts waiting to be initialized
  const chartQueue = [];
  let isProcessingQueue = false;
  
  // Initialize a single chart
  function initChart(container) {
    const chartId = container.id;
    if (initializedCharts.has(chartId)) return;
    
    initializedCharts.add(chartId);
    container.dataset.loaded = 'true';
    
    // Remove skeleton loader
    const skeleton = container.querySelector('.chart-skeleton');
    if (skeleton) {
      skeleton.style.opacity = '0';
      setTimeout(() => skeleton.remove(), 300);
    }
    
    // Show the actual chart content
    const chartContent = container.querySelector('.chart-content');
    if (chartContent) {
      chartContent.style.display = 'block';
      // Trigger any chart resize/redraw if needed
      setTimeout(() => {
        if (window.Highcharts) {
          Highcharts.charts.forEach(chart => {
            if (chart && chart.reflow) chart.reflow();
          });
        }
      }, 50);
    }
  }
  
  // Process chart queue in batches
  function processQueue() {
    if (isProcessingQueue || chartQueue.length === 0) return;
    
    isProcessingQueue = true;
    const batchSize = 3;
    const batch = chartQueue.splice(0, batchSize);
    
    batch.forEach(container => initChart(container));
    
    if (chartQueue.length > 0) {
      requestIdleCallback(() => {
        isProcessingQueue = false;
        processQueue();
      }, { timeout: 2000 });
    } else {
      isProcessingQueue = false;
    }
  }
  
  // Intersection Observer for scroll-based lazy loading
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting && entry.target.dataset.loaded === 'false') {
        chartQueue.push(entry.target);
        observer.unobserve(entry.target);
        processQueue();
      }
    });
  }, { rootMargin: '300px' });
  
  // Initialize observers when DOM is ready
  function initLazyLoading() {
    document.querySelectorAll('.chart-lazy-container[data-loaded="false"]').forEach(container => {
      observer.observe(container);
    });
  }
  
  // Tab-aware rendering: load charts when tab becomes visible
  function initTabAwareLoading() {
    document.querySelectorAll('.panel-tabset').forEach(tabset => {
      const tabs = tabset.querySelectorAll('[role="tab"]');
      
      tabs.forEach(tab => {
        tab.addEventListener('click', function() {
          // Small delay to ensure tab panel is visible
          setTimeout(() => {
            const targetId = this.getAttribute('aria-controls');
            if (!targetId) return;
            
            const targetPanel = document.getElementById(targetId);
            if (!targetPanel) return;
            
            // Initialize any lazy charts in this tab
            const lazyCharts = targetPanel.querySelectorAll('.chart-lazy-container[data-loaded="false"]');
            lazyCharts.forEach(chart => {
              chartQueue.push(chart);
              observer.unobserve(chart);
            });
            processQueue();
          }, 50);
        });
      });
    });
  }
  
  // Start lazy loading when document is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
      initLazyLoading();
      initTabAwareLoading();
    });
  } else {
    initLazyLoading();
    initTabAwareLoading();
  }
})();
</script>
```

